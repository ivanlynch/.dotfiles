---
- name: Install ZSH on Arch Linux
  community.general.pacman:
    name: zsh
    state: present
  become: true

- name: Change shell to zsh
  ansible.builtin.user:
    name: "{{ ansible_user_id }}"
    shell: /bin/zsh
  become: true

- name: Check if Oh-My-Zsh is installed
  ansible.builtin.stat:
    path: ~/.oh-my-zsh
  register: oh_my_zsh

- name: Install Oh-My-Zsh
  ansible.builtin.shell: >
    curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh | sh
  args:
    creates: ~/.oh-my-zsh
  when: not oh_my_zsh.stat.exists
